# Тесты генератора G-code

Модуль тестирования для проверки корректности работы генератора G-code для иглопробивного станка.

## Структура тестов

### 1. Базовые тесты функциональности (`test_basic_functionality.py`)
Быстрые unit-тесты для проверки основных компонентов:
- Валидация параметров
- Геометрические расчёты
- Генерация команд движения
- Форматирование G-code

### 2. Тесты генерации G-code (`test_gcode_generation.py`)

#### Тест производительности (`test_generation_performance`)
- Проверяет скорость генерации (должна быть < 5 секунд)
- Измеряет время выполнения полного цикла генерации

#### Интеграционный тест (`test_generation_matches_reference`)
Сравнивает сгенерированный G-code с эталонным файлом.

**Особенности сравнения:**
- **Warnings (не ошибки):**
  - Несовпадения в заголовке файла (header)
  - Несовпадения в комментариях к строкам

- **Tolerance для осей:**
  Числовое сравнение идёт с учётом допуска, если он задан.
  Можно задать допуск только для определённых осей, например:
  ```python
  tolerance={'X': 0.01, 'Y': 0.01}  # только для X и Y
  tolerance={'A': 0.1}               # только для оси вращения
  ```

### 3. GUI тесты (`test_gui.py`)

#### Тест запуска приложения (`test_gui_application_launch`)
Smoke test: проверяет, что GUI приложение запускается без исключений.
- Создаёт экземпляр приложения
- Показывает главное окно
- Автоматически закрывается через 100мс
- Если исключений не возникло - тест пройден

## Запуск тестов

### Все тесты сразу
```bash
python3 run_tests.py
# или
python3 tests/test_runner.py
```

### Отдельные модули
```bash
python3 tests/test_basic_functionality.py
python3 tests/test_gcode_generation.py
python3 tests/test_gui.py
```

### Конкретный тест
```bash
python3 -m unittest tests.test_gcode_generation.TestGCodeGeneration.test_generation_performance
```

## Эталонные файлы

- `tests/g_code_origin.txt` - эталонный G-code для сравнения
- При изменении алгоритма требует обновления

## Порядок выполнения

Тесты запускаются в оптимальном порядке (от быстрых к медленным):
1. Базовые тесты функциональности (быстрые unit-тесты)
2. Тест производительности
3. GUI smoke test
4. Интеграционный тест (самый долгий)
